This code has been written by Hossein Mousavi